<!DOCTYPE html>
<html lang="en-us">

<head>
  

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>

<link rel="shortcut icon" type="image/png" href="/favicon.ico"/>


<link rel='stylesheet' href='http://docs.joinmastodon.org/style.min.8428ac02267958b2de442b315ef56e6329acae2d40cff3fd939a3d3f8926aa03.css'>


<script src='http://docs.joinmastodon.org/main.min.db37c27117ff8400e5e30549f6806d2bc825668b596d81316c6148417f59bc72.js' async></script>


  <title>Database index corruption - Mastodon documentation</title>

  <meta property="og:type" content="article">
  <meta property="og:url" content="http://docs.joinmastodon.org/pl/admin/troubleshooting/index-corruption/">

  
    <meta name="description" content="How to recover from database index corruption.">
    <meta property="og:description" content="How to recover from database index corruption.">
    <meta name="twitter:description" content="How to recover from database index corruption.">
  

  <meta name="twitter:title" content="Database index corruption">
  <meta name="twitter:site" content="@joinmastodon">

  <link rel="canonical" href="http://docs.joinmastodon.org/pl/admin/troubleshooting/index-corruption/">
</head>

<body>
  <div class="container sidebar-layout">
    <nav class="sidebar"><a class="brand" href="/">
  <img class="link-logo" src="/brand.svg" alt="Mastodon" />
</a>

<ul>
  
  
    <li>
      
        <a href="/pl/" class="">Czym jest Mastodon?</a>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">Korzystanie z Mastodona</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/user/signup/" class="">Signing up for an account</a>

              
            </li>
          
            <li>
              <a href="/pl/user/profile/" class="">Setting up your profile</a>

              
            </li>
          
            <li>
              <a href="/pl/user/posting/" class="">Posting toots</a>

              
            </li>
          
            <li>
              <a href="/pl/user/network/" class="">Using the network features</a>

              
            </li>
          
            <li>
              <a href="/pl/user/moderating/" class="">Dealing with unwanted content</a>

              
            </li>
          
            <li>
              <a href="/pl/user/discoverability/" class="">Promoting yourself and others</a>

              
            </li>
          
            <li>
              <a href="/pl/user/preferences/" class="">Set your preferences</a>

              
            </li>
          
            <li>
              <a href="/pl/user/contacts/" class="">More settings</a>

              
            </li>
          
            <li>
              <a href="/pl/user/external/" class="">Using Mastodon externally</a>

              
            </li>
          
            <li>
              <a href="/pl/user/moving/" class="">Moving or leaving accounts</a>

              
            </li>
          
            <li>
              <a href="/pl/user/run-your-own/" class="">Running your own server</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Uruchamianie Mastodona</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/admin/prerequisites/" class="">Preparing your machine</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/install/" class="">Installing from source</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/config/" class="">Configuring your environment</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/optional/" class="">Installing optional features</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/admin/optional/elasticsearch/" class="">Full-text search</a>
                    </li>
                  
                    <li>
                      <a href="/pl/admin/optional/tor/" class="">Hidden services</a>
                    </li>
                  
                    <li>
                      <a href="/pl/admin/optional/sso/" class="">Single Sign On</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/admin/setup/" class="">Setting up your new instance</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/tootctl/" class="">Using the admin CLI</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/upgrading/" class="">Upgrading to a new release</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/backups/" class="">Backing up your server</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/migrating/" class="">Migrating to a new machine</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/scaling/" class="">Scaling up your server</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/moderation/" class="">Moderation actions</a>

              
            </li>
          
            <li>
              <a href="/pl/admin/troubleshooting/" class="">Troubleshooting errors</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Tworzenie aplikacji dla Mastodona</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/client/intro/" class="">Getting started with the API</a>

              
            </li>
          
            <li>
              <a href="/pl/client/public/" class="">Playing with public data</a>

              
            </li>
          
            <li>
              <a href="/pl/client/token/" class="">Obtaining client app access</a>

              
            </li>
          
            <li>
              <a href="/pl/client/authorized/" class="">Logging in with an account</a>

              
            </li>
          
            <li>
              <a href="/pl/client/guidelines/" class="">Guidelines and best practices</a>

              
            </li>
          
            <li>
              <a href="/pl/client/libraries/" class="">Libraries and implementations</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Współtworzenie Mastodona</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/dev/overview/" class="">Technical overview</a>

              
            </li>
          
            <li>
              <a href="/pl/dev/setup/" class="">Setting up a dev environment</a>

              
            </li>
          
            <li>
              <a href="/pl/dev/code/" class="">Code structure</a>

              
            </li>
          
            <li>
              <a href="/pl/dev/routes/" class="">Routes</a>

              
            </li>
          
            <li>
              <a href="/pl/dev/disclosure/" class="">Bug bounties and responsible disclosure</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Zgodność ze specyfikacją</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/spec/activitypub/" class="">ActivityPub</a>

              
            </li>
          
            <li>
              <a href="/pl/spec/webfinger/" class="">WebFinger</a>

              
            </li>
          
            <li>
              <a href="/pl/spec/security/" class="">Security</a>

              
            </li>
          
            <li>
              <a href="/pl/spec/microformats/" class="">Microformats</a>

              
            </li>
          
            <li>
              <a href="/pl/spec/oauth/" class="">OAuth</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">API REST</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/api/oauth-scopes/" class="">OAuth Scopes</a>

              
            </li>
          
            <li>
              <a href="/pl/api/rate-limits/" class="">Rate limits</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Metody API</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/methods/apps/" class="">apps</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/methods/apps/oauth/" class="">oauth</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/methods/accounts/" class="">accounts</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/methods/accounts/bookmarks/" class="">bookmarks</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/favourites/" class="">favourites</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/mutes/" class="">mutes</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/blocks/" class="">blocks</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/domain_blocks/" class="">domain_blocks</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/filters/" class="">filters</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/reports/" class="">reports</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/follow_requests/" class="">follow_requests</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/endorsements/" class="">endorsements</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/featured_tags/" class="">featured_tags</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/preferences/" class="">preferences</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/accounts/suggestions/" class="">suggestions</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/methods/statuses/" class="">statuses</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/methods/statuses/media/" class="">media</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/statuses/polls/" class="">polls</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/statuses/scheduled_statuses/" class="">scheduled_statuses</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/methods/timelines/" class="">timelines</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/methods/timelines/conversations/" class="">conversations</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/timelines/lists/" class="">lists</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/timelines/markers/" class="">markers</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/timelines/streaming/" class="">streaming</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/methods/notifications/" class="">notifications</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/methods/notifications/push/" class="">push</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/methods/search/" class="">search</a>

              
            </li>
          
            <li>
              <a href="/pl/methods/instance/" class="">instance</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/pl/methods/instance/trends/" class="">trends</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/instance/directory/" class="">directory</a>
                    </li>
                  
                    <li>
                      <a href="/pl/methods/instance/custom_emojis/" class="">custom_emojis</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/pl/methods/admin/" class="">admin</a>

              
            </li>
          
            <li>
              <a href="/pl/methods/announcements/" class="">announcements</a>

              
            </li>
          
            <li>
              <a href="/pl/methods/proofs/" class="">proofs</a>

              
            </li>
          
            <li>
              <a href="/pl/methods/oembed/" class="">oembed</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Jednostki API</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/entities/account/" class="">Account</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/activity/" class="">Activity</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/admin-account/" class="">Admin::Account</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/admin-report/" class="">Admin::Report</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/announcement/" class="">Announcement</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/announcementreaction/" class="">AnnouncementReaction</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/application/" class="">Application</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/attachment/" class="">Attachment</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/card/" class="">Card</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/context/" class="">Context</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/conversation/" class="">Conversation</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/emoji/" class="">Emoji</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/error/" class="">Error</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/featuredtag/" class="">FeaturedTag</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/field/" class="">Field</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/filter/" class="">Filter</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/history/" class="">History</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/identityproof/" class="">IdentityProof</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/instance/" class="">Instance</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/list/" class="">List</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/marker/" class="">Marker</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/mention/" class="">Mention</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/notification/" class="">Notification</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/poll/" class="">Poll</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/preferences/" class="">Preferences</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/pushsubscription/" class="">PushSubscription</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/relationship/" class="">Relationship</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/report/" class="">Report</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/results/" class="">Results</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/scheduledstatus/" class="">ScheduledStatus</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/source/" class="">Source</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/status/" class="">Status</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/tag/" class="">Tag</a>

              
            </li>
          
            <li>
              <a href="/pl/entities/token/" class="">Token</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">admin-troubleshooting</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/pl/admin/troubleshooting/index-corruption/" class="active">Database index corruption</a>

              
            </li>
          
        </ul>
      
    </li>
  
</ul>
</nav>
    <main>
  <h1>Database index corruption</h1>

  
    <p>How to recover from database index corruption.</p>
  
  <aside>
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#explanation">Locale data and collation</a></li>
        <li><a href="#am-i-affected">Am I affected by this issue?</a></li>
        <li><a href="#fixing">Fixing the issue</a></li>
        <li><a href="#avoiding-the-issue">Avoiding the issue</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </aside>
  <div class="e-content">
    <p>A somewhat common configuration issue can lead to index corruption throughout the database. This page attempts to explain why this may occur and how to fix it.</p>
<h2 id="explanation">Locale data and collation</h2>
<p>Textual values in the database, such as usernames, or toot identifiers, are compared using so-called collation rules defining how characters are ordered and how to change their case.
When setting up a database, Mastodon will use the database server&rsquo;s default locale settings, including the default collation rules, which often is defined by the operating system&rsquo;s settings.</p>
<p>Unfortunately, in late 2018, a <code>glibc</code> update changed the collation rules for many locales, which means databases using an affected locale would now order textual values differently.
Since the database indexes are algorithmic structures which rely on the ordering of the values they are indexing, some of them would become inconsistent.</p>
<p>More information: <a href="https://wiki.postgresql.org/wiki/Locale_data_changes">https://wiki.postgresql.org/wiki/Locale_data_changes</a> <a href="https://postgresql.verite.pro/blog/2018/08/27/glibc-upgrade.html">https://postgresql.verite.pro/blog/2018/08/27/glibc-upgrade.html</a></p>
<h2 id="am-i-affected">Am I affected by this issue?</h2>
<p>If your database is not using <code>C</code> or <code>POSIX</code> for its collation setting (which you can check with <code>SELECT datcollate FROM pg_database WHERE datname = current_database();</code>),
your indexes might be inconsistent, if you ever ran with a version of glibc prior to 2.28 and did not immediately reindex your databases after updating to glibc 2.28 or newer.</p>
<p>You can check whether your indexes are consistent using <a href="https://www.postgresql.org/docs/10/amcheck.html">PostgreSQL&rsquo;s <code>amcheck</code> module</a>: as the database server&rsquo;s super user, connect to your Mastodon database and issue the following (this may take a while):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL"><span style="color:#ff79c6">CREATE</span> EXTENSION <span style="color:#ff79c6">IF</span> <span style="color:#ff79c6">NOT</span> <span style="color:#ff79c6">EXISTS</span> amcheck;
<span style="color:#ff79c6">SELECT</span> bt_index_check(<span style="color:#ff79c6">c</span>.oid)
<span style="color:#ff79c6">FROM</span> pg_index i
<span style="color:#ff79c6">JOIN</span> pg_class <span style="color:#ff79c6">c</span> <span style="color:#ff79c6">ON</span> i.indexrelid <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">c</span>.oid
<span style="color:#ff79c6">WHERE</span> <span style="color:#ff79c6">c</span>.relname <span style="color:#ff79c6">IN</span> (<span style="color:#f1fa8c">&#39;index_account_domain_blocks_on_account_id_and_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_account_proofs_on_account_and_provider_and_username&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_accounts_on_username_and_domain_lower&#39;</span>, <span style="color:#f1fa8c">&#39;index_accounts_on_uri&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_accounts_on_url&#39;</span>, <span style="color:#f1fa8c">&#39;index_conversations_on_uri&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_custom_emoji_categories_on_name&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_custom_emojis_on_shortcode_and_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_devices_on_access_token_id&#39;</span>, <span style="color:#f1fa8c">&#39;index_domain_allows_on_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_domain_blocks_on_domain&#39;</span>, <span style="color:#f1fa8c">&#39;index_email_domain_blocks_on_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_invites_on_code&#39;</span>, <span style="color:#f1fa8c">&#39;index_markers_on_user_id_and_timeline&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_media_attachments_on_shortcode&#39;</span>, <span style="color:#f1fa8c">&#39;index_preview_cards_on_url&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_statuses_on_uri&#39;</span>, <span style="color:#f1fa8c">&#39;index_tags_on_name_lower&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_tombstones_on_uri&#39;</span>, <span style="color:#f1fa8c">&#39;index_unavailable_domains_on_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_users_on_email&#39;</span>, <span style="color:#f1fa8c">&#39;index_webauthn_credentials_on_external_id&#39;</span>
);
</code></pre></div><p>If this raises an error, your database is corrupted and needs fixing. If it does not, you may need to perform more involved checks to be sure.
Unlike the previous checks, those more involved checks will lock tables when running, thus interfering with the availability of your instance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SQL" data-lang="SQL"><span style="color:#ff79c6">CREATE</span> EXTENSION <span style="color:#ff79c6">IF</span> <span style="color:#ff79c6">NOT</span> <span style="color:#ff79c6">EXISTS</span> amcheck;
<span style="color:#ff79c6">SELECT</span> bt_index_parent_check(<span style="color:#ff79c6">c</span>.oid)
<span style="color:#ff79c6">FROM</span> pg_index i
<span style="color:#ff79c6">JOIN</span> pg_class <span style="color:#ff79c6">c</span> <span style="color:#ff79c6">ON</span> i.indexrelid <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">c</span>.oid
<span style="color:#ff79c6">WHERE</span> <span style="color:#ff79c6">c</span>.relname <span style="color:#ff79c6">IN</span> (<span style="color:#f1fa8c">&#39;index_account_domain_blocks_on_account_id_and_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_account_proofs_on_account_and_provider_and_username&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_accounts_on_username_and_domain_lower&#39;</span>, <span style="color:#f1fa8c">&#39;index_accounts_on_uri&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_accounts_on_url&#39;</span>, <span style="color:#f1fa8c">&#39;index_conversations_on_uri&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_custom_emoji_categories_on_name&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_custom_emojis_on_shortcode_and_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_devices_on_access_token_id&#39;</span>, <span style="color:#f1fa8c">&#39;index_domain_allows_on_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_domain_blocks_on_domain&#39;</span>, <span style="color:#f1fa8c">&#39;index_email_domain_blocks_on_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_invites_on_code&#39;</span>, <span style="color:#f1fa8c">&#39;index_markers_on_user_id_and_timeline&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_media_attachments_on_shortcode&#39;</span>, <span style="color:#f1fa8c">&#39;index_preview_cards_on_url&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_statuses_on_uri&#39;</span>, <span style="color:#f1fa8c">&#39;index_tags_on_name_lower&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_tombstones_on_uri&#39;</span>, <span style="color:#f1fa8c">&#39;index_unavailable_domains_on_domain&#39;</span>,
  <span style="color:#f1fa8c">&#39;index_users_on_email&#39;</span>, <span style="color:#f1fa8c">&#39;index_webauthn_credentials_on_external_id&#39;</span>
);
</code></pre></div><p>If this succeeds, without returning an error, your database should be consistent, and you can safely disregard the warning Mastodon emits when running <code>db:migrate</code>.</p>
<h2 id="fixing">Fixing the issue</h2>
<p>Unless you take action, if you are affected, your database could get more and more inconsistent as the time pass. Therefore, it is important to fix it as soon as possible.</p>
<p>Before attempting to fix your database, stop Mastodon and make a backup of your database. Then, you may try running <code>tootctl maintenance fix-duplicates</code>.
This tool will walk through the database to find duplicate and fix them. In some cases, those operations are destructive.
In the most destructive cases, you will be asked to chose which record to keep. In all cases, walking through the whole database in search of duplicates is an extremely long operation.</p>
<h2 id="avoiding-the-issue">Avoiding the issue</h2>
<p>To avoid the issue, reindex your database immediately after any libc update.</p>


    <p style="color: #687590;">
      Ostatnio aktualizowano December 4, 2020 · <a href='https://github.com/tootsuite/documentation/tree/master/content/pl/admin/troubleshooting/index-corruption.md' style="color: #687590;">Popraw tę stronę</a>

      
        <br />

        Dostępne również w języku:

        
          <a href="http://docs.joinmastodon.org/admin/troubleshooting/index-corruption/" style="color: #687590;" hreflang="en">English</a>
        
      
    </p>

  </div>
</main>
  </div>

  <footer class="footer container">
  <div class="sponsorship">
    <div class="container">
      <h2>
        Sponsorzy
      </h2>

      <div class="logo-grid">
        <div>
          <a href="https://www.dotcom-monitor.com/es/">
            <img src="/assets/sponsors/dotcom-monitor-logo.png" alt="Dotcom-Monitor" />
          </a>

          <a href="https://www.loadview-testing.com/api-testing/">
            <img src="/assets/sponsors/LoadView-logo.png" alt="LoadView" />
          </a>

          <a href="https://webhostingbuddy.com/wordpress-hosting/">
            <img src="/assets/sponsors/web-hosting-buddy-logo.png" alt="Web Hosting Buddy" />
          </a>

          <a href="https://www.drivencoffee.com/">
            <img src="/assets/sponsors/driven-coffee-logo.png" alt="Driven Coffee" />
          </a>
        </div>
      </div>
    </div>
  </div>

  <p class="legal legal--right">
    <a href='https://joinmastodon.org'>Dołącz do Mastodona</a> · <a href='https://blog.joinmastodon.org'>Blog</a> · <a href='https://mastodon.social/@Mastodon' target='_blank'><i class='fab fa-mastodon'></i></a> · <a href='https://twitter.com/joinmastodon' rel='nofollow' target='_blank'><i class='fab fa-twitter'></i></a>
  </p>

  <p class="legal"><a href='https://github.com/tootsuite/documentation/tree/master/content/pl/admin/troubleshooting/index-corruption.md'>Zobacz źródła</a> · <a href='https://creativecommons.org/licenses/by-sa/4.0/'>CC BY-SA 4.0</a> · <a href='https://joinmastodon.org/imprint'>Imprint</a></p>
</footer>

</body>

</html>
